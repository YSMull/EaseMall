webpackJsonp([3],{179:function(t,e,s){"use strict";function i(t){n||s(268)}Object.defineProperty(e,"__esModule",{value:!0});var o=s(227),a=s(272),n=!1,r=s(4),c=i,d=r(o.a,a.a,!1,c,"data-v-a83bd3b0",null);d.options.__file="src/views/index.vue",e.default=d.exports},227:function(t,e,s){"use strict";var i=s(269);s(2);e.a={components:{Ecard:i.a},data:function(){return{goodsList:[],filterGoodsList:[],region:"all",searchText:""}},methods:{changeRegion:function(t){this.search()},changeRegion1:function(t){this.search()},search:function(){var t=this;this.filterGoodsList=this.goodsList.filter(function(e){return"all"===t.region?e.name.indexOf(t.searchText)>-1:"unpurchase"===t.region?e.name.indexOf(t.searchText)>-1&&0==e.bought:"bought"===t.region?e.name.indexOf(t.searchText)>-1&&1==e.bought:"sold"===t.region?e.name.indexOf(t.searchText)>-1&&e.hasSold>0:void 0})},fetchData:function(){var t=this,e=null;e=!0===this.$store.state.isseller?this.$http.get("/goods/published"):this.$http.get("/goods/all");var s=[e];if(!0===this.$store.state.isbuyer){var i=this.$http.get("/history");s.push(i)}Promise.all(s).then(function(e){var s=e[0].data.data;s=s.map(function(t){return t.bought=!1,t}),e.length>=2&&e[1].data.data.forEach(function(t){var e=t.goodsId;s.forEach(function(t){t.id==e&&(t.bought=!0)})}),t.goodsList=s,t.filterGoodsList=s})}},beforeMount:function(){this.$Spin.show()},mounted:function(){console.log("index mounted"),this.$Spin.hide(),this.fetchData()}}},228:function(t,e,s){"use strict";var i=s(145),o=s.n(i);e.a={directives:{imagesLoaded:o.a},props:{id:Number,name:String,price:Number,picUrl:String,bought:Boolean,desc:String,hasSold:Number},data:function(){return{exsits:!0,isImgLoaded:!1}},methods:{onClick:function(){this.$router.push({name:"goods",params:{goodsId:this.id}})},deleteGoods:function(){var t=this;this.$Modal.confirm({title:"确认删除商品？",content:"",onOk:function(){t.$http.delete("/goods/delete/"+t.id).then(function(e){t.exsits=!1,t.$Message.success("删除成功")})},onCancel:function(){}})},imageProgress:function(t,e){e.isLoaded&&(e.img.width=e.img.height,this.isImgLoaded=!0)}},mounted:function(){}}},268:function(t,e){},269:function(t,e,s){"use strict";function i(t){n||s(270)}var o=s(228),a=s(271),n=!1,r=s(4),c=i,d=r(o.a,a.a,!1,c,"data-v-64c2db13",null);d.options.__file="src/common/e-card.vue",e.a=d.exports},270:function(t,e){},271:function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.exsits?s("div",{staticClass:"e-card",on:{click:t.onClick}},[this.$store.state.isseller?s("p",[t._v("已卖出 "),s("strong",[t._v(t._s(null!=t.hasSold?t.hasSold:0))]),t._v(" 件")]):t._e(),t._v(" "),0===t.hasSold?s("span",{staticClass:"e-delete",on:{click:function(e){e.stopPropagation(),t.deleteGoods(e)}}},[t._v("删除")]):t._e(),t._v(" "),s("lazy-component",{staticStyle:{height:"212.8px"}},[s("div",{directives:[{name:"images-loaded",rawName:"v-images-loaded:on.progress",value:t.imageProgress,expression:"imageProgress",arg:"on",modifiers:{progress:!0}}]},[s("img",{directives:[{name:"show",rawName:"v-show",value:t.isImgLoaded,expression:"isImgLoaded"}],staticClass:"e-img",class:{"e-img-bought":t.bought},attrs:{src:t.picUrl,alt:t.name}}),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.isImgLoaded,expression:"!isImgLoaded"}],staticStyle:{position:"relative",height:"218px"}},[s("Spin",{attrs:{fix:"",size:"large"}})],1)])]),t._v(" "),s("strong",{staticClass:"e-price",class:{"e-price-bought":t.bought},domProps:{textContent:t._s(t.price)}}),t._v(" "),t.bought?s("span",{staticClass:"e-bought"},[s("b",[t._v("已购买")])]):t._e(),t._v(" "),s("p",{staticClass:"e-name"},[s("strong",[t._v(t._s(t.name))])]),t._v(" "),s("p",{staticClass:"e-desc",domProps:{textContent:t._s(t.desc)}})],1):t._e()},o=[];i._withStripped=!0;var a={render:i,staticRenderFns:o};e.a=a},272:function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"index"},[s("BackTop"),t._v(" "),s("Row",{staticStyle:{margin:"10px"},attrs:{type:"flex",justify:"end",align:"middle"}},[s("Col",{staticStyle:{"text-align":"right"},attrs:{xs:24,sm:14,md:8,lg:6}},[this.$store.state.islogin&&this.$store.state.isbuyer?s("RadioGroup",{on:{"on-change":t.changeRegion},model:{value:t.region,callback:function(e){t.region=e},expression:"region"}},[s("Radio",{attrs:{label:"all"}},[t._v("全部")]),t._v(" "),s("Radio",{attrs:{label:"unpurchase"}},[t._v("未购买")]),t._v(" "),s("Radio",{attrs:{label:"bought"}},[t._v("已购买")])],1):t._e(),t._v(" "),this.$store.state.islogin&&this.$store.state.isseller?s("RadioGroup",{on:{"on-change":t.changeRegion1},model:{value:t.region,callback:function(e){t.region=e},expression:"region"}},[s("Radio",{attrs:{label:"all"}},[t._v("全部")]),t._v(" "),s("Radio",{attrs:{label:"sold"}},[t._v("已卖出")])],1):t._e()],1),t._v(" "),s("Col",{staticStyle:{"text-align":"right"},attrs:{xs:24,sm:10,md:8,lg:6}},[s("Input",{staticStyle:{"max-width":"266px"},attrs:{icon:"ios-search"},on:{"on-change":t.search},model:{value:t.searchText,callback:function(e){t.searchText=e},expression:"searchText"}})],1)],1),t._v(" "),s("Row",t._l(t.filterGoodsList,function(t){return s("Col",{key:t.id,attrs:{xs:12,sm:8,md:8,lg:6}},[s("Ecard",{attrs:{id:t.id,name:t.name,price:t.price,picUrl:t.picUrl,desc:t.description,bought:t.bought,hasSold:t.hasSold}})],1)}))],1)},o=[];i._withStripped=!0;var a={render:i,staticRenderFns:o};e.a=a}});